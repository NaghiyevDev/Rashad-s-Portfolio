import{getShortContent as t}from"./utils.js";import{CONFIG as n}from"./config.js";let e=1;const a=n.API_URL;export async function getBlogs(n=1,o=10){const i=window.location.pathname.split("/").pop();var l,s;if(!i||["blogs.html","blogs"].includes(i))try{const i=await fetch(`${a}/blogs/?page=${n}&limit=${o}`);if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const r=await i.json(),c=document.getElementById("blog-container"),d=document.getElementById("pagination-container");if(e=r.page,!r.data||0===r.data.length)return c.innerHTML="<div>Blog Not Found</div>",void(document.querySelector(".pagination-section").style.display="none");l=r.data,(s=c).innerHTML="",l.forEach((n=>{const e=document.createElement("div");e.classList.add("card");const o=n.img?`${a}/${n.img}`:"/assets/gallery/no-image.jpg",i=t(n.content.trim(),100),l=t(n.title,35);e.innerHTML=`\n      <a href="/blog-detail.html?id=${n.id}" class="blog-detail-link">\n        <img class="blog-img" src="${o}" alt="${n.title}" loading="lazy">\n        <div class="blog-content">\n          <h2>${l}</h2>\n          <p>${i}</p>\n        </div>\n      </a>\n    `,s.appendChild(e)})),function(t,n,e,a){a.innerHTML="";const o=Math.ceil(t/e);if(o<=1)return;const i=5;let l=Math.max(1,n-2),s=Math.min(o,l+i-1);l=Math.max(1,Math.min(l,o-i+1)),s=Math.min(o,l+i-1);const r=(t,n,a=!1,o=!1)=>{const i=document.createElement("a");return i.className="page-link",i.href="#",i.innerText=n,a&&i.classList.add("disabled"),o&&i.classList.add("active"),i.addEventListener("click",(n=>{n.preventDefault(),a||getBlogs(t,e)})),i};a.appendChild(r(n-1,"«",1===n));for(let t=l;t<=s;t++)a.appendChild(r(t,t,!1,t===n));a.appendChild(r(n+1,"»",n===o))}(r.total,r.page,r.limit,d)}catch(t){console.error("Failed to load blogs:",t),document.getElementById("blog-container").innerHTML="<div>Error loading blogs. Please try again later.</div>"}}export async function getLatestBlogs(){const n=window.location.pathname.split("/").pop();if(!n||"index.html"===n||"/"===n||""===n)try{const n=await fetch(`${a}/blogs/?page=1&limit=3&type=latest-blog`);if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const e=await n.json(),o=document.getElementById("blog-container"),i=e.data;if(0===i.length)return void(o.innerHTML="<div>Blog Not Found</div>");i.forEach((n=>{const e=t(n.content.trim(),300),i=t(n.title,35),l=document.createElement("div");l.className="card";const s=n.img?n.img:"/assets/gallery/no-image.jpg";l.innerHTML=`\n        <a href="/blog-detail.html?id=${n.id}" class="blog-detail-link">\n          <img class="blog-img" src="${a}/${s}" alt="${n.title}" loading="lazy">\n          <div class="blog-content">\n            <h2>${i}</h2>\n            <p>${e}</p>\n          </div>\n        </a>\n      `,o.appendChild(l)}))}catch(t){console.error("Failed to load blogs:",t)}}